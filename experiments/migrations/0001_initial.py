# Generated by Django 5.2.4 on 2025-07-31 07:06

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Experiment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200, verbose_name='实验名称')),
                ('description', models.TextField(blank=True, null=True, verbose_name='实验描述')),
                ('task_type', models.CharField(choices=[('detect', '目标检测'), ('segment', '实例分割'), ('classify', '图像分类'), ('pose', '姿态估计'), ('track', '目标跟踪')], default='detect', max_length=20, verbose_name='任务类型')),
                ('model_name', models.CharField(default='yolov8n.pt', max_length=100, verbose_name='模型名称')),
                ('data_path', models.CharField(max_length=500, verbose_name='数据集路径')),
                ('epochs', models.IntegerField(default=100, verbose_name='训练轮数')),
                ('batch_size', models.IntegerField(default=16, verbose_name='批量大小')),
                ('image_size', models.IntegerField(default=640, verbose_name='图像大小')),
                ('learning_rate', models.FloatField(default=0.01, verbose_name='学习率')),
                ('weight_decay', models.FloatField(default=0.0005, verbose_name='权重衰减')),
                ('device', models.CharField(default='auto', max_length=20, verbose_name='设备')),
                ('workers', models.IntegerField(default=8, verbose_name='工作进程数')),
                ('project_name', models.CharField(blank=True, max_length=100, null=True, verbose_name='项目名称')),
                ('experiment_name', models.CharField(blank=True, max_length=100, null=True, verbose_name='实验名称')),
                ('save_dir', models.CharField(blank=True, max_length=500, null=True, verbose_name='保存目录')),
                ('status', models.CharField(choices=[('pending', '等待中'), ('running', '运行中'), ('completed', '已完成'), ('failed', '失败'), ('cancelled', '已取消')], default='pending', max_length=20, verbose_name='状态')),
                ('command', models.TextField(blank=True, null=True, verbose_name='生成的命令')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新时间')),
                ('started_at', models.DateTimeField(blank=True, null=True, verbose_name='开始时间')),
                ('completed_at', models.DateTimeField(blank=True, null=True, verbose_name='完成时间')),
                ('log_file', models.CharField(blank=True, max_length=500, null=True, verbose_name='日志文件')),
                ('result_file', models.CharField(blank=True, max_length=500, null=True, verbose_name='结果文件')),
                ('error_message', models.TextField(blank=True, null=True, verbose_name='错误信息')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='创建用户')),
            ],
            options={
                'verbose_name': '实验',
                'verbose_name_plural': '实验',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ExperimentLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('timestamp', models.DateTimeField(auto_now_add=True, verbose_name='时间戳')),
                ('level', models.CharField(default='INFO', max_length=20, verbose_name='日志级别')),
                ('message', models.TextField(verbose_name='日志信息')),
                ('experiment', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='logs', to='experiments.experiment', verbose_name='实验')),
            ],
            options={
                'verbose_name': '实验日志',
                'verbose_name_plural': '实验日志',
                'ordering': ['-timestamp'],
            },
        ),
    ]
